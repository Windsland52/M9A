{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "type": "object",
    "properties": {
        "custom_action": {
            "enum": [
                "Screenshot",
                "DisableNode",
                "NodeOverride",
                "ResetCount",
                "DuringAct",
                "DuringAnecdote",
                "DuringRe_release",
                "BankPurchaseRecord",
                "ModifyBankTaskList",
                "SwitchCombatTimes",
                "PsychubeDoubleTimes",
                "LucidscapeStageSelect",
                "LucidscapeStatusDetect",
                "TeamSelect",
                "CombatTargetLevel",
                "SummonlngSwipe",
                "SOD_DifficultySelect",
                "ActivityTargetLevel",
                "SelectChapter",
                "SelectCombatStage",
                "TargetCount",
                "JudgeDepthsOfMythWeekly"
            ]
        }
    },
    "anyOf": [
        {
            "$ref": "#/$defs/Screenshot"
        },
        {
            "$ref": "#/$defs/DisableNode"
        },
        {
            "$ref": "#/$defs/NodeOverride"
        },
        {
            "$ref": "#/$defs/ResetCount"
        },
        {
            "$ref": "#/$defs/DuringAct"
        },
        {
            "$ref": "#/$defs/DuringAnecdote"
        },
        {
            "$ref": "#/$defs/DuringRe_release"
        },
        {
            "$ref": "#/$defs/BankPurchaseRecord"
        },
        {
            "$ref": "#/$defs/ModifyBankTaskList"
        },
        {
            "$ref": "#/$defs/SwitchCombatTimes"
        },
        {
            "$ref": "#/$defs/PsychubeDoubleTimes"
        },
        {
            "$ref": "#/$defs/LucidscapeStageSelect"
        },
        {
            "$ref": "#/$defs/LucidscapeStatusDetect"
        },
        {
            "$ref": "#/$defs/TeamSelect"
        },
        {
            "$ref": "#/$defs/CombatTargetLevel"
        },
        {
            "$ref": "#/$defs/SummonlngSwipe"
        },
        {
            "$ref": "#/$defs/SOD_DifficultySelect"
        },
        {
            "$ref": "#/$defs/ActivityTargetLevel"
        },
        {
            "$ref": "#/$defs/SelectChapter"
        },
        {
            "$ref": "#/$defs/SelectCombatStage"
        },
        {
            "$ref": "#/$defs/TargetCount"
        },
        {
            "$ref": "#/$defs/JudgeDepthsOfMythWeekly"
        }
    ],
    "$defs": {
        "RequiredParam": {
            "anyOf": [
                {
                    "required": [
                        "custom_action_param"
                    ]
                },
                {
                    "required": [
                        "custom_action_param_code"
                    ]
                }
            ]
        },
        "Screenshot": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "Screenshot",
                    "description": "自定义截图动作，保存当前屏幕截图到指定目录"
                },
                "custom_action_param": {
                    "type": "object",
                    "description": "截图动作的参数配置",
                    "properties": {
                        "save_dir": {
                            "type": "string",
                            "description": "保存截图的目录路径"
                        }
                    },
                    "required": [
                        "save_dir"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "DisableNode": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "DisableNode",
                    "description": "将特定 node 设置为 disable 状态 。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "node_name": {
                            "type": "string",
                            "description": "需要设置为 disable 状态的节点名称"
                        }
                    },
                    "required": [
                        "node_name"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "NodeOverride": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "NodeOverride",
                    "description": "在 node 中执行 pipeline_override 。"
                },
                "custom_action_param": {
                    "type": "object",
                    "patternProperties": {
                        "^.*$": {
                            "type": "object",
                            "description": "节点覆盖配置，键为节点名称，值为覆盖参数对象",
                            "additionalProperties": true
                        }
                    }
                }
            }
        },
        "ResetCount": {
            "properties": {
                "custom_action": {
                    "const": "ResetCount",
                    "description": "重置计数器的值。无参数或空参数调用时置空全部计数器。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "node_name": {
                            "type": "string",
                            "description": "需要重置计数器的节点名称"
                        }
                    },
                    "unevaluatedProperties": false
                }
            }
        },
        "DuringAct": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "DuringAct",
                    "description": "判断当前是否在作战开放期间。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "resource": {
                            "type": "string",
                            "enum": [
                                "cn",
                                "en",
                                "jp"
                            ],
                            "default": "cn",
                            "description": "资源版本，决定使用的数据和时区"
                        }
                    },
                    "required": [
                        "resource"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "DuringAnecdote": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "DuringAnecdote",
                    "description": "判断当前是否在轶事开放期间。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "resource": {
                            "type": "string",
                            "enum": [
                                "cn",
                                "en",
                                "jp"
                            ],
                            "default": "cn",
                            "description": "资源版本，决定使用的数据和时区"
                        }
                    },
                    "required": [
                        "resource"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "DuringRe_release": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "DuringRe_release",
                    "description": "判断当前是否在复刻开放期间。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "resource": {
                            "type": "string",
                            "enum": [
                                "cn",
                                "en",
                                "jp"
                            ],
                            "default": "cn",
                            "description": "资源版本，决定使用的数据和时区"
                        }
                    },
                    "required": [
                        "resource"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "BankPurchaseRecord": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "BankPurchaseRecord",
                    "description": "记录在银行购买物品的时间戳。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "item": {
                            "type": "string",
                            "description": "物品名称"
                        }
                    },
                    "required": [
                        "item"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "ModifyBankTaskList": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "ModifyBankTaskList",
                    "description": "根据本地记录的物品购买时间修改任务链。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "resource": {
                            "type": "string",
                            "enum": [
                                "cn",
                                "en",
                                "jp"
                            ],
                            "default": "cn",
                            "description": "资源版本，决定使用的时区"
                        }
                    },
                    "required": [
                        "resource"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "SwitchCombatTimes": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "SwitchCombatTimes",
                    "description": "选择战斗次数。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "times": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 4,
                            "description": "目标次数"
                        }
                    },
                    "required": [
                        "times"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "PsychubeDoubleTimes": {
            "properties": {
                "custom_action": {
                    "const": "PsychubeDoubleTimes",
                    "description": "识别加成次数，根据结果覆盖 PsychubeVictoryOverrideTask 中参数。"
                }
            }
        },
        "LucidscapeStageSelect": {
            "properties": {
                "custom_action": {
                    "const": "LucidscapeStageSelect",
                    "description": "醒梦域界面，选择最新可进入片段。"
                }
            }
        },
        "LucidscapeStatusDetect": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "LucidscapeStatusDetect",
                    "description": "醒梦域片段界面，通过检测当前状态决定后续动作。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "stage": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 4,
                            "description": "所处深眠片段"
                        }
                    },
                    "unevaluatedProperties": false
                }
            }
        },
        "TeamSelect": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "TeamSelect",
                    "description": "选择作战队伍。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "team": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 4
                        }
                    },
                    "required": [
                        "team"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "CombatTargetLevel": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "CombatTargetLevel",
                    "description": "选择主线作战目标难度。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "level": {
                            "type": "string",
                            "enum": [
                                "童话",
                                "故事",
                                "厄险"
                            ],
                            "description": "目标难度"
                        }
                    },
                    "required": [
                        "level"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "SummonlngSwipe": {
            "properties": {
                "custom_action": {
                    "const": "SummonlngSwipe",
                    "description": "分派魔精滑动名片。"
                }
            }
        },
        "SOD_DifficultySelect": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "SOD_DifficultySelect",
                    "description": "黄昏的音序难度选择。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "level": {
                            "type": "string",
                            "enum": [
                                "5",
                                "10",
                                "11",
                                "cur",
                                "max"
                            ],
                            "description": "目标难度，5|10|11|cur(当前)|max(最高)"
                        }
                    },
                    "required": [
                        "level"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "ActivityTargetLevel": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "CombatTargetLevel",
                    "description": "选择活动作战目标难度。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "level": {
                            "type": "string",
                            "enum": [
                                "故事",
                                "意外",
                                "艰难"
                            ],
                            "description": "目标难度"
                        }
                    },
                    "required": [
                        "level"
                    ],
                    "unevaluatedProperties": false
                }
            }
        },
        "SelectChapter": {
            "properties": {
                "custom_action": {
                    "const": "SelectChapter",
                    "description": "选择主线章节。"
                }
            }
        },
        "SelectCombatStage": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "SelectCombatStage",
                    "description": "处理关卡和难度信息，并修改后续任务。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "stage": {
                            "type": "string"
                        },
                        "level": {
                            "type": "string",
                            "enum": [
                                "Hard",
                                "Story"
                            ],
                            "description": "目标难度"
                        }
                    },
                    "required": [
                        "stage",
                        "level"
                    ],
                    "unevaluatedProperties": true
                }
            }
        },
        "TargetCount": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "TargetCount",
                    "description": "根据设定的目标次数和吃糖方式刷图。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "target_count": {
                            "type": "integer",
                            "minimum": 0,
                            "description": "目标次数，不填或填0表示清空体力"
                        }
                    },
                    "unevaluatedProperties": false
                }
            }
        },
        "JudgeDepthsOfMythWeekly": {
            "allOf": [
                {
                    "$ref": "#/$defs/RequiredParam"
                }
            ],
            "properties": {
                "custom_action": {
                    "const": "JudgeDepthsOfMythWeekly",
                    "description": "记录在雨中悬想每周扫荡的时间戳。"
                },
                "custom_action_param": {
                    "type": "object",
                    "properties": {
                        "resource": {
                            "type": "string",
                            "enum": [
                                "cn",
                                "en",
                                "jp"
                            ],
                            "default": "cn",
                            "description": "资源版本，决定使用的时区"
                        }
                    },
                    "required": [
                        "resource"
                    ],
                    "unevaluatedProperties": false
                }
            }
        }
    }
}